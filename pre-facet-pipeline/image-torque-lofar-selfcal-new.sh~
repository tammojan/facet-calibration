#! /bin/bash

# send email alerts to this address
#PBS -M twshimwell@gmail.com
# mail alerts for end of job or aborted job
#PBS -m ea

# set name of job
#PBS -N GENERICPIPE

# set the error log file location
#PBS -j oe

# set max wallclock time and memory
#PBS -l walltime=400:00:00

# set the number of nodes and processes per node
#PBS -l nodes=1:ppn=20:para13


######################## END PBS ##############################################
export OMP_NUM_THREADS=20


# Observation dir
OBS_DIR=$PBS_O_WORKDIR

# start job from the directory it was submitted
cd $PBS_O_WORKDIR


## bash stop on error ##
set -e
## bash output things helpful for debugging ##
set -x

# source the lofar software
source /home/wwilliams/.lofarinit.sh
source /home/wwilliams/init_lofar_tools.sh

export PYTHONPATH=/net/kolkje/data2/shimwell/General/Total-Checked-Out-svn/my_library/trunk/:$PYTHONPATH
export PYTHONPATH=/home/shimwell/Desktop/work/LOFAR/lofarcodes:$PYTHONPATH
export PYTHONPATH=/net/kolkje/data2/shimwell/:$PYTHONPATH
export PYTHONPATH=/net/kolkje/data2/shimwell/losoto/tools:$PYTHONPATH
export HDF5_DISABLE_VERSION_CHECK=1
export PYTHONPATH=/net/para10/data1/shimwell/pipeline/PipelineExample/face-cal-scripts:$PYTHONPATH

### Run selfcal
#./run_example_new.sh > run_example_new.out 2>&1
#./run_a2034.sh > run_a2034.out 2>&1
#./run_a2034_withselfcal.sh > run_a2034_withselfcal.out 2>&1
./run_survey.sh > run_survey.out 2>&1
